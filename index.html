<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>PTN Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f5f7fa;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    h2 {
      margin-top: 20px;
      margin-bottom: 10px;
      color: #2c3e50;
    }
    .card {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      border: none;
      background: #3498db;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    button:hover {
      background: #2980b9;
    }
    iframe {
      border: 1px solid #ddd;
      border-radius: 8px;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      width: 100%;
      min-height: 600px;
      margin-bottom: 20px;
    }

    /* Link th∆∞ m·ª•c */
    .folder-links a {
      display: block;
      margin: 6px 0;
      padding: 8px 12px;
      background: #ecf0f1;
      border-radius: 6px;
      color: #2980b9;
      font-weight: bold;
      text-decoration: none;
      transition: 0.2s;
    }
    .folder-links a:hover {
      background: #d6eaf8;
      text-decoration: underline;
    }
    .custom-file {
      display: inline-block;
      padding: 14px 22px;
      background: #3498db;
      color: white;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
      margin-bottom: 10px;
    }

    .custom-file:hover {
      background: #217dbb;
    }

    #cameraInput {
      display: none; /* ·∫®N INPUT FILE */
    }
    /* --- STYLE B·∫¢NG 5 C·ªòT 29 H√ÄNG --- */
    .quick-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 14px;
    border-radius: 10px;
    overflow: hidden;
  }
  .quick-table th {
    background: #dfe9f3;
    padding: 12px;
    border: 1px solid #b9c9d6;
    font-weight: bold;
  }
  .quick-table td {
    padding: 10px;
    border: 1px solid #d0d7de;
    text-align: center;
    background: #ffffff;
  }
  .quick-table tr:nth-child(even) td {
    background: #f7f9fb;
  }
  .quick-table td a {
    display: block;
    padding: 6px;
    border-radius: 6px;
    text-decoration: none;
    color: #0066cc;
    font-weight: bold;
    transition: 0.25s;
  }
  .quick-table td a:hover {
    background: #e6f0ff;
    color: #ff6600;
    transform: translateY(-2px);
  }
  .section-content {
    display: none;
    margin-top: 10px;
  }

  .collapsible {
    cursor: pointer;
    user-select: none;
    padding: 6px 0;
  }

  /* icon m≈©i t√™n ƒë·∫πp */
  .collapsible::after {
    content: " ‚ñº";
    font-weight: bold;
    font-size: 14px;
    transition: 0.2s;
  }

  .collapsible.active::after {
    content: " ‚ñ≤";
  }
  </style>
</head>
<body>
  <h1>PTN Dashboard</h1>
  <h2>M·ª•c l·ª•c</h2>
  <div class="toc">
    <ul>
        <li><a href="#1">Ch·ª•p ·∫£nh th√≠ nghi·ªám</a></li>
        <li><a href="#2">Quy tr√¨nh l√†m th√≠ nghi·ªám</a></li>
        <li><a href="#3">C√°c d·ª•ng c·ª• v√† thi·∫øt b·ªã</a></li>
        <li><a href="#4">S·ªë h√≥a ph√≤ng LAS</a></li>
        <li><a href="#5">Theo d√µi ti·∫øn ƒë·ªô th√≠ nghi·ªám h·ªë khoan</a></li>
        <li><a href="#6">C√¥ng vi·ªác & Theo d√µi</a></li>
        <li><a href="#7">C√°c th∆∞ m·ª•c quan tr·ªçng</a></li>
        <li><a href="#8">C√°c bi·ªÉu quan tr·ªçng</a></li>
    </ul>
  </div>

  <!-- Camera -->
  <h2 id="1">Ch·ª•p ·∫£nh th√≠ nghi·ªám</h2> 

  <!-- PC: th√¥ng b√°o -->
  <div id="pcCamera">
    <p>Truy c·∫≠p b·∫±ng ƒëi·ªán tho·∫°i ƒë·ªÉ ch·ª•p h√¨nh ngay trong dashboard v√† upload. Sau khi ch·ª•p xong, nh·∫•n upload, h√¨nh ·∫£nh s·∫Ω v√†o th∆∞ m·ª•c drive ·∫¢nh th√≠ nghi·ªám</p>
  </div>

  <!-- Mobile camera -->
  <div id="mobileCamera" style="display:none;">
    <p>Truy c·∫≠p b·∫±ng ƒëi·ªán tho·∫°i ƒë·ªÉ ch·ª•p h√¨nh ngay trong dashboard v√† upload. Sau khi ch·ª•p xong, nh·∫•n upload, h√¨nh ·∫£nh s·∫Ω v√†o th∆∞ m·ª•c drive ·∫¢nh th√≠ nghi·ªám</p>
    <label for="cameraInput" class="custom-file">üì∑ Ch·ªçn ·∫£nh / Ch·ª•p ·∫£nh</label>
    <input type="file" accept="image/*" capture="environment" id="cameraInput">
    <button id="uploadBtn">Upload (Mobile)</button>
  </div>
  <hr>
  <h2 id="2">Quy tr√¨nh l√†m th√≠ nghi·ªám</h2>
  <table class="quick-table">
  <tr>
    <th rowspan="2">C√¥ng vi·ªác chung</th>
    <th colspan="4">C√¥ng vi·ªác ri√™ng</th>
  </tr>
  <tr>
    <th>Nh√¢n vi√™n 1</th>
    <th>Nh√¢n vi√™n 2</th>
    <th>Nh√¢n vi√™n 3</th>
    <th>Nh√¢n vi√™n 4</th>
  </tr>
  <!-- H√†ng 3 -->
  <tr><td><a href="#">Ghi S·ªï M·ªü M·∫´u</a></td><td><a href="#">C·∫Øt ph·∫≥ng</a></td><td><a href="#">Ph∆°i m·∫´u ch·∫£y d·∫ªo</a></td><td><a href="#">R·ª≠a h·ªôp nh√¥m</a></td><td><a href="#">So·∫°n m·∫´u</a></td></tr>

  <!-- H√†ng 4 -->
  <tr><td><a href="#">Ghi tem v√† ghi bi·ªÉu</a></td><td><a href="#">R·ª≠a d·ª•ng c·ª• c·∫Øt ph·∫≥ng</a></td><td><a href="#">Xay m·∫´u ch·∫£y d·∫ªo</a></td><td><a href="#">C√¢n dung tr·ªçng</a></td><td><a href="#">ƒê·∫©y m·∫´u b·ªè</a></td></tr>

  <!-- H√†ng 5 -->
  <tr><td><a href="#">Chu·∫©n b·ªã b√†n m·ªü m·∫´u</a></td><td><a href="#">ƒê√°nh ch·∫£y</a></td><td><a href="#">ƒê√°nh m·∫´u ch·∫£y d·∫ªo</a></td><td><a href="#">C√¢n ·∫©m ∆∞·ªõt</a></td><td><a href="#">Ph·ª• c√°c th√≠ nghi·ªám kh√°c</a></td></tr>

  <!-- H√†ng 6 -->
  <tr><td><a href="#">ƒê·∫©y m·∫´u ra ƒë·ªÉ TN</a></td><td><a href="#">R·ª≠a t√¥ v√† d·ª•ng c·ª• ƒë√°nh ch·∫£y</a></td><td><a href="#">Ch·∫•t t·∫£i n√©n nhanh</a></td><td><a href="#">D·ª° n√©n nhanh</a></td><td><a href="#"></a></td></tr>

  <!-- H√†ng 7 -->
  <tr><td><a href="#">Chia m·∫´u</a></td><td><a href="#"></a></td><td><a href="#">Ghi n√©n nhanh</a></td><td><a href="#">L·∫Øp n√©n</a></td><td><a href="#"></a></td></tr>

  <!-- H√†ng 8 -->
  <tr><td><a href="#">M√¥ t·∫£ m·∫´u</a></td><td><a href="#"></a></td><td><a href="#">LƒÉn d·∫ªo</a></td><td><a href="#">R·ª≠a ·ªëng ƒëong</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">Gia c√¥ng dao v√≤ng</a></td><td><a href="#"></a></td><td><a href="#">C√¢n ·∫©m v√† ch·∫£y d·∫ªo kh√¥</a></td><td><a href="#">ƒê√¢m xay h·∫°t</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">M·ªü SPT</a></td><td><a href="#"></a></td><td><a href="#">Ch·∫•t t·∫£i v√† ghi c·ªë k·∫øt</a></td><td><a href="#">L√†m emax emin</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">Cho m·∫´u ƒë√£ m·ªü v√†o t·ªß s·∫•y</a></td><td><a href="#"></a></td><td><a href="#">D·ª° c·ªë k·∫øt</a></td><td><a href="#">C√¢n t√¥ 200g</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">V·ªá sinh sau m·ªü m·∫´u</a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">S√†ng ch√©n</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">R·ª≠a d·ª•ng c·ª• m·ªü m·∫´u</a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">C√¢n ch√©n</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">Cho m·∫´u ƒë√£ l√†m v√†o t·ªß s·∫•y</a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">R·ª≠a khay h·∫°t</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">V·ªá sinh chung</a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">Qu√©t d·ªçn v·ªá sinh h·∫°t</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">T·∫°o bi·ªÉu</a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">N·∫•u n∆∞·ªõc ƒë·ªï n∆∞·ªõc</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">Nh·∫≠p s·ªë li·ªáu</a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">R√¢y t√¥</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#">Kh√°c</a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">R√¢y ch√©n</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">ƒê·ªçc h·∫°t</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">S√†ng kh√¥</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">R·ª≠a t√¥ ch√©n</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">Gia c√¥ng UC</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">N√©n UC</a></td><td><a href="#"></a></td></tr>
  <tr><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#"></a></td><td><a href="#">Lau ki·∫øng</a></td><td><a href="#"></a></td></tr>

</table>
  <h2 id="3">C√°c d·ª•ng c·ª• v√† thi·∫øt b·ªã</h2>
  <h2 id="4">S·ªë h√≥a ph√≤ng LAS</h2>
  <ul>
      <li><a href="Tools/H∆Ø·ªöNG D·∫™N T·∫†O BI·ªÇU V√Ä NH·∫¨P S·ªê LI·ªÜU T·ª∞ ƒê·ªòNG.pdf">‚¨á H∆Ø·ªöNG D·∫™N T·∫†O BI·ªÇU V√Ä NH·∫¨P S·ªê LI·ªÜU T·ª∞ ƒê·ªòNG</a></li>
      <li><a href="https://drive.google.com/file/d/1I_i59J6CWOY17SkNFbZaJKKup5o5NMQ6/view?usp=sharing">‚¨á PH·∫¶N M·ªÄM T·∫†O BI·ªÇU T·ª∞ ƒê·ªòNG</a></li>
  </ul>
  <!-- SHEETS -->
  <h2 class="collapsible" id="5">Theo d√µi ti·∫øn ƒë·ªô th√≠ nghi·ªám h·ªë khoan</h2>
  <div class="section-content">
  <p>Ti·∫øn ƒë·ªô h·ªë khoan ƒë∆∞·ª£c hi·ªÉn th·ªã khi nh·∫≠p s·ªï m·ªü m·∫´u v√† s·ªë li·ªáu th√≠ nghi·ªám v√†o bi·ªÉu Google Sheets trong th∆∞ m·ª•c Bi·ªÉu nh·∫≠p s·ªë th√≠ nghi·ªám. Ch·ªçn t√™n h·ªë khoan trong ph·∫ßn x·ªï xu·ªëng ƒë·ªÉ hi·ªán th·ªã bi·ªÉu c√≥ t√™n t∆∞∆°ng ·ª©ng.</p>
  <select id="sheetSelector"></select>
<div id="sheetContainer"></div>

<script>
async function loadSheets() {
  const response = await fetch("https://script.google.com/macros/s/AKfycbxicVGWO8hV0Lk90vrKqQV7w-Z-kNQWhvFcBzzSSDgVfN3ASR2vb4tcPB8qFgl4zHoT/exec");
  const sheets = await response.json();
  const selector = document.getElementById("sheetSelector");
  const container = document.getElementById("sheetContainer");

  // t·∫°o option
  sheets.forEach(sheet => {
    const opt = document.createElement("option");
    opt.value = sheet.url;
    opt.textContent = sheet.name;
    selector.appendChild(opt);
  });

  // n·∫øu c√≥ √≠t nh·∫•t 1 file th√¨ hi·ªÉn th·ªã lu√¥n file ƒë·∫ßu ti√™n
  if (sheets.length > 0) {
    selector.value = sheets[0].url; // ch·ªçn m·∫∑c ƒë·ªãnh
    container.innerHTML = `
      <div class="sheet-frame">
        <iframe src="${sheets[0].url}" width="100%" height="600" frameborder="0"></iframe>
      </div>`;
  }

  // ƒë·ªïi khi ch·ªçn dropdown
  selector.addEventListener("change", () => {
    container.innerHTML = `
      <div class="sheet-frame">
        <iframe src="${selector.value}" width="100%" height="600" frameborder="0"></iframe>
      </div>`;
  });
}

loadSheets();
</script>
</div>

  <!-- Form + Sheets -->
  <h2 class="collapsible" id="6">C√¥ng vi·ªác & Theo d√µi</h2>
  <div class="section-content">
  <p>M·ªói ng√†y, c√°c TNV ƒëi·ªÅn th√¥ng tin v√† ƒë√°nh d·∫•u c√°c c√¥ng ƒëo·∫°n tham gia v√†o Google Form v√† g·ª≠i ƒëi, d·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c l∆∞u l·∫°i v√† th·ªëng k√™.</p>
  <!-- Google Form -->
  <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfRll9yQzmv5t9OHBKAZFYpNKtb6chKqn8lcJ3nfc1U8NFEiA/viewform?embedded=true"></iframe>
  <p>Sau khi nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu t·ª´ Google Form, bi·ªÉu Google Sheets sau ƒë√¢y s·∫Ω x·ª≠ l√Ω d·ªØ li·ªáu ƒë√≥ v√† t√≠nh ƒëi·ªÉm cho t·ª´ng TNV theo t·ª´ng ng√†y v√† t√≠nh ƒëi·ªÉm trung b√¨nh theo s·ªë ng√†y t√πy ch·ªçn.</p>

  <!-- Google Sheets -->
  <iframe src="https://docs.google.com/spreadsheets/d/1t6ZJf5wu2iSf5spfFx-fP8tT9-AZUEQ-17xUn8YiSMo/edit?usp=sharing"></iframe>
  </div>
  <hr>
  <!-- Google Drive folders -->
  <h2 id="7">C√°c th∆∞ m·ª•c quan tr·ªçng</h2> 
  <div class="folder-links">
    <a href="https://drive.google.com/drive/folders/1yed3TBGnktmakcwekL60fOOOBgousdA_?usp=sharing">·∫¢nh th√≠ nghi·ªám</a>
    <a href="https://drive.google.com/drive/folders/1Onjlnxh62Br5QglU_YCJ67jG8JYt6nBn?usp=sharing">Y√™u c·∫ßu th√≠ nghi·ªám</a>
    <a href="https://drive.google.com/drive/folders/11DVnrcLxa3NHv-Y23emDZ36Lob3BwB9N?usp=sharing">Bi·ªÉu nh·∫≠p s·ªë th√≠ nghi·ªám</a>
    <a href="https://drive.google.com/drive/folders/12KTIuFwtOtChzj6dXV9Mpfgk6FsiBWXx?usp=sharing">C√°c c√¥ng c·ª• t·ª± ƒë·ªông h√≥a</a>
  </div>
  <h2 id="8">C√°c bi·ªÉu quan tr·ªçng</h2> 
  <p>Bi·ªÉu hi·ªÉn th·ªã ·ªü dashboard ch·ªâ ƒë·ªÉ theo d√µi, tr√°nh ch·ªânh s·ª≠a. N·∫øu mu·ªën ch·ªânh s·ª≠a, vui l√≤ng truy c·∫≠p v√†o c√°c link sau v√† y√™u c·∫ßu c·∫•p quy·ªÅn truy c·∫≠p ƒë·ªÉ ƒë·∫£m b·∫£o t√≠nh b·∫£o m·∫≠t.</p>
  <div class="folder-links">
    <a href="https://docs.google.com/spreadsheets/d/15WLUyBcH235TF4f0KaM145X5Pv2kvi7DaqhyTAxg8rQ/edit?usp=sharing">Bi·ªÉu theo d√µi ti·∫øn ƒë·ªô h·ªë khoan</a>
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfRll9yQzmv5t9OHBKAZFYpNKtb6chKqn8lcJ3nfc1U8NFEiA/viewform?usp=sharing&ouid=105033677416426965311">Form theo d√µi c√¥ng vi·ªác h√†ng ng√†y</a>
    <a href="https://docs.google.com/spreadsheets/d/1t6ZJf5wu2iSf5spfFx-fP8tT9-AZUEQ-17xUn8YiSMo/edit?usp=sharing">Bi·ªÉu th·ªëng k√™ ƒëi·ªÉm c·ªßa c√°c TNV</a>
  </div>
  <p style="text-align: center; font-weight: bold; font-size: 22px;">
  ‚ãÜÔΩ°‚ÄßÀö öüçì…ûÀö‚ÄßÔΩ°‚ãÜCH√öC C√ÅC B·∫†N L√ÄM VI·ªÜC HI·ªÜU QU·∫¢ V√Ä VUI V·∫∫!‚ãÜÔΩ°‚ÄßÀö öüçì…ûÀö‚ÄßÔΩ°‚ãÜ
</p>

<script>
document.querySelectorAll(".collapsible").forEach(h2 => {
  h2.addEventListener("click", () => {
    h2.classList.toggle("active");
    const content = h2.nextElementSibling;
    content.style.display = content.style.display === "block" ? "none" : "block";
  });
});
</script>  
</body>

<script>
  const isMobile = /Mobi|Android/i.test(navigator.userAgent);

  // N·∫øu l√† mobile th√¨ hi·ªán input upload
  if (isMobile) {
    document.getElementById('pcCamera').style.display = 'none';
    document.getElementById('mobileCamera').style.display = 'block';
  }

  // Mobile: upload t·ª´ input file
  const input = document.getElementById('cameraInput');
  const uploadBtn = document.getElementById('uploadBtn');
  if (uploadBtn) {
    uploadBtn.onclick = () => {
      if (!input.files.length) {
        alert("Ch∆∞a ch·ªçn ·∫£nh");
        return;
      }
      const file = input.files[0];
      const ext = file.name.split('.').pop().toLowerCase();   // l·∫•y ƒëu√¥i g·ªëc
      const reader = new FileReader();
      reader.onloadend = () => {
        uploadImage(reader.result, "mobile_" + Date.now() + "." + ext);
      };
      reader.readAsDataURL(file);
    };
  }
  // H√†m resize & upload
  function uploadImage(dataUrl, filename, maxWidth = 1024, maxHeight = 1024) {
    const img = new Image();
    img.onload = () => {
      let width = img.width;
      let height = img.height;
      const ratio = Math.min(maxWidth / width, maxHeight / height, 1);
      width *= ratio;
      height *= ratio;

      const canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0, width, height);

      const resizedDataUrl = canvas.toDataURL("image/jpeg", 0.8);
      const mimeMatch = resizedDataUrl.match(/^data:(image\/\w+);base64,/);
      const mimeType = mimeMatch ? mimeMatch[1] : "image/jpeg";
      const base64Data = resizedDataUrl.replace(/^data:image\/\w+;base64,/, "").replace(/\s/g, "");

      fetch("/.netlify/functions/uploadProxy", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          image: base64Data,
          filename: filename,
          mimeType: mimeType
        })
      })
      .then(res => res.json())
      .then(txt => {
        if(txt.status === "success") {
          alert("Uploaded: " + txt.fileUrl);
        } else {
          alert("Upload error: " + txt.message);
        }
      })
      .catch(err => alert("Upload failed: " + err));
    };
    img.src = dataUrl;
  }
</script>
  
</html>







































