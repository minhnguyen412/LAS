<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>PTN Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f5f7fa;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    h2 {
      margin-top: 20px;
      margin-bottom: 10px;
      color: #2c3e50;
    }
    .card {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    button {
      margin-top: 10px;
      padding: 10px 20px;
      border: none;
      background: #3498db;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    button:hover {
      background: #2980b9;
    }
    iframe {
      border: 1px solid #ddd;
      border-radius: 8px;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      width: 100%;
      min-height: 600px;
      margin-bottom: 20px;
    }

    /* Link thÆ° má»¥c */
    .folder-links a {
      display: block;
      margin: 6px 0;
      padding: 8px 12px;
      background: #ecf0f1;
      border-radius: 6px;
      color: #2980b9;
      font-weight: bold;
      text-decoration: none;
      transition: 0.2s;
    }
    .folder-links a:hover {
      background: #d6eaf8;
      text-decoration: underline;
    }
    .custom-file {
      display: inline-block;
      padding: 14px 22px;
      background: #3498db;
      color: white;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      text-align: center;
      margin-bottom: 10px;
    }

    .custom-file:hover {
      background: #217dbb;
    }

    #cameraInput {
      display: none; /* áº¨N INPUT FILE */
    }
    /* --- STYLE Báº¢NG 5 Cá»˜T 29 HÃ€NG --- */
    .quick-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 14px;
    border-radius: 10px;
    overflow: hidden;
  }
  .quick-table th {
    background: #dfe9f3;
    padding: 12px;
    border: 1px solid #b9c9d6;
    font-weight: bold;
  }
  .quick-table td {
    padding: 10px;
    border: 1px solid #d0d7de;
    text-align: center;
    background: #ffffff;
  }
  .quick-table tr:nth-child(even) td {
    background: #f7f9fb;
  }
  .quick-table td a {
    display: block;
    padding: 6px;
    border-radius: 6px;
    text-decoration: none;
    color: #0066cc;
    font-weight: bold;
    transition: 0.25s;
  }
  .quick-table td a:hover {
    background: #e6f0ff;
    color: #ff6600;
    transform: translateY(-2px);
  }
  </style>
</head>
<body>
  <h1>PTN Dashboard</h1> 
  <!-- Google Drive folders -->
  <h2>CÃ¡c thÆ° má»¥c quan trá»ng</h2> 
  <div class="folder-links">
    <a href="https://drive.google.com/drive/folders/1yed3TBGnktmakcwekL60fOOOBgousdA_?usp=sharing">áº¢nh thÃ­ nghiá»‡m</a>
    <a href="https://drive.google.com/drive/folders/1Onjlnxh62Br5QglU_YCJ67jG8JYt6nBn?usp=sharing">YÃªu cáº§u thÃ­ nghiá»‡m</a>
    <a href="https://drive.google.com/drive/folders/11DVnrcLxa3NHv-Y23emDZ36Lob3BwB9N?usp=sharing">Biá»ƒu nháº­p sá»‘ thÃ­ nghiá»‡m</a>
  </div>

  <!-- Camera -->
  <h2>Chá»¥p áº£nh thÃ­ nghiá»‡m</h2> 

  <!-- PC: thÃ´ng bÃ¡o -->
  <div id="pcCamera">
    <p>Truy cáº­p báº±ng Ä‘iá»‡n thoáº¡i Ä‘á»ƒ chá»¥p hÃ¬nh ngay trong dashboard vÃ  upload. Sau khi chá»¥p xong, nháº¥n upload, hÃ¬nh áº£nh sáº½ vÃ o thÆ° má»¥c drive áº¢nh thÃ­ nghiá»‡m</p>
  </div>

  <!-- Mobile camera -->
  <div id="mobileCamera" style="display:none;">
    <p>Truy cáº­p báº±ng Ä‘iá»‡n thoáº¡i Ä‘á»ƒ chá»¥p hÃ¬nh ngay trong dashboard vÃ  upload. Sau khi chá»¥p xong, nháº¥n upload, hÃ¬nh áº£nh sáº½ vÃ o thÆ° má»¥c drive áº¢nh thÃ­ nghiá»‡m</p>
    <label for="cameraInput" class="custom-file">ğŸ“· Chá»n áº£nh / Chá»¥p áº£nh</label>
    <input type="file" accept="image/*" capture="environment" id="cameraInput">
    <button id="uploadBtn">Upload (Mobile)</button>
  </div>
  <hr>
  <table class="quick-table">
  <tr>
    <th rowspan="2">CÃ´ng viá»‡c chung</th>
    <th colspan="4">CÃ´ng viá»‡c riÃªng</th>
  </tr>
  <tr>
    <th>ThÃ­ nghiá»‡m Giá»›i háº¡n cháº£y</th>
    <th>ThÃ­ nghiá»‡m Giá»›i háº¡n dáº»oy</th>
    <th>ThÃ­ nghiá»‡m ThÃ nh pháº§n háº¡t</th>
    <th>Phá»¥ ThÃ­ nghiá»‡m</th>
  </tr>
  <!-- HÃ ng 3 -->
  <tr><td><a href="#">Ghi Sá»• Má»Ÿ Máº«u</a></td><td><a href="#">Cáº¯t pháº³ng</a></td><td><a href="#">PhÆ¡i máº«u cháº£y dáº»o</a></td><td><a href="#">Rá»­a há»™p nhÃ´m</a></td><td><a href="#">Soáº¡n máº«u</a></td></tr>

  <!-- HÃ ng 4 -->
  <tr><td><a href="#">Ghi tem</a></td><td><a href="#">Rá»­a dá»¥ng cá»¥ cáº¯t pháº³ng</a></td><td><a href="#">Xay máº«u cháº£y dáº»o</a></td><td><a href="#">CÃ¢n dung trá»ng</a></td><td><a href="#">Äáº©y máº«u bá»</a></td></tr>

  <!-- HÃ ng 5 -->
  <tr><td><a href="#">Chuáº©n bá»‹ bÃ n má»Ÿ máº«u</a></td><td><a href="#">ÄÃ¡nh cháº£y</a></td><td><a href="#">ÄÃ¡nh máº«u cháº£y dáº»o</a></td><td><a href="#">CÃ¢n áº©m Æ°á»›t</a></td><td><a href="#">Phá»¥ cÃ¡c thÃ­ nghiá»‡m khÃ¡c</a></td></tr>

  <!-- HÃ ng 6 -->
  <tr><td><a href="#">Äáº©y máº«u ra Ä‘á»ƒ TN</a></td><td><a href="#">Rá»­a tÃ´ vÃ  dá»¥ng cá»¥ Ä‘Ã¡nh cháº£y</a></td><td><a href="#">Cháº¥t táº£i nÃ©n nhanh</a></td><td><a href="#">Dá»¡ táº£i nÃ©n nhanh</a></td><td><a href="#">Link 20</a></td></tr>

  <!-- HÃ ng 7 -->
  <tr><td><a href="#">Chia máº«u</a></td><td><a href="#">Link 22</a></td><td><a href="#">Ghi nÃ©n nhanh</a></td><td><a href="#">Dá»¡ dao vÃ²ng nÃ©n nhanh</a></td><td><a href="#">Link 25</a></td></tr>

  <!-- HÃ ng 8 -->
  <tr><td><a href="#">MÃ´ táº£ máº«u</a></td><td><a href="#">Link 27</a></td><td><a href="#">LÄƒn dáº»o</a></td><td><a href="#">Láº¯p nÃ©n</a></td><td><a href="#">Link 30</a></td></tr>

  <!-- Tao tiáº¿p tá»¥c generate Ä‘á»§ 29 hÃ ng -->

  <tr><td><a href="#">Gia cÃ´ng dao vÃ²ng</a></td><td><a href="#">Link 32</a></td><td><a href="#">CÃ¢n áº©m vÃ  cháº£y dáº»o khÃ´</a></td><td><a href="#">Rá»­a á»‘ng Ä‘ong</a></td><td><a href="#">Link 35</a></td></tr>
  <tr><td><a href="#">Má»Ÿ SPT</a></td><td><a href="#">Link 37</a></td><td><a href="#">Cháº¥t táº£i cá»‘ káº¿t</a></td><td><a href="#">ÄÃ¢m háº¡t</a></td><td><a href="#">Link 40</a></td></tr>
  <tr><td><a href="#">Cho máº«u Ä‘Ã£ má»Ÿ vÃ o tá»§ sáº¥y</a></td><td><a href="#">Link 42</a></td><td><a href="#">Ghi cá»‘ káº¿t trÆ°á»›c 15â€™</a></td><td><a href="#">Xay háº¡t</a></td><td><a href="#">Link 45</a></td></tr>
  <tr><td><a href="#">Vá»‡ sinh sau má»Ÿ máº«u</a></td><td><a href="#">Link 47</a></td><td><a href="#">Ghi cá»‘ káº¿t sau 15â€™</a></td><td><a href="#">Link 49</a></td><td><a href="#">Link 50</a></td></tr>
  <tr><td><a href="#">Rá»­a dá»¥ng cá»¥ má»Ÿ máº«u</a></td><td><a href="#">Link 52</a></td><td><a href="#"></a></td><td><a href="#">LÃ m emax emin</a></td><td><a href="#">Link 55</a></td></tr>
  <tr><td><a href="#">Cho máº«u Ä‘Ã£ lÃ m vÃ o tá»§ sáº¥y</a></td><td><a href="#">Link 57</a></td><td><a href="#">Dá»¡ cá»‘ káº¿t</a></td><td><a href="#">CÃ¢n tÃ´ 200g</a></td><td><a href="#">Link 60</a></td></tr>
  <tr><td><a href="#">Vá»‡ sinh chung</a></td><td><a href="#">Link 62</a></td><td><a href="#">Link 63</a></td><td><a href="#">SÃ ng chÃ©n</a></td><td><a href="#">Link 65</a></td></tr>
  <tr><td><a href="#">Táº¡o biá»ƒu</a></td><td><a href="#">Link 67</a></td><td><a href="#">Link 68</a></td><td><a href="#">CÃ¢n chÃ©n</a></td><td><a href="#">Link 70</a></td></tr>
  <tr><td><a href="#">Nháº­p sá»‘ liá»‡u</a></td><td><a href="#">Link 72</a></td><td><a href="#">Link 73</a></td><td><a href="#">Rá»­a khay háº¡t</a></td><td><a href="#">Link 75</a></td></tr>
  <tr><td><a href="#">KhÃ¡c</a></td><td><a href="#">Link 77</a></td><td><a href="#">Link 78</a></td><td><a href="#">QuÃ©t dá»n vá»‡ sinh háº¡t</a></td><td><a href="#">Link 80</a></td></tr>
  <tr><td><a href="#">Link 81</a></td><td><a href="#">Link 82</a></td><td><a href="#">Link 83</a></td><td><a href="#">Náº¥u nÆ°á»›c Ä‘á»• nÆ°á»›c</a></td><td><a href="#">Link 85</a></td></tr>
  <tr><td><a href="#">Link 86</a></td><td><a href="#">Link 87</a></td><td><a href="#">Link 88</a></td><td><a href="#">RÃ¢y tÃ´</a></td><td><a href="#">Link 90</a></td></tr>
  <tr><td><a href="#">Link 91</a></td><td><a href="#">Link 92</a></td><td><a href="#">Link 93</a></td><td><a href="#">RÃ¢y chÃ©n</a></td><td><a href="#">Link 95</a></td></tr>
  <tr><td><a href="#">Link 96</a></td><td><a href="#">Link 97</a></td><td><a href="#">Link 98</a></td><td><a href="#">Äá»c háº¡t 5â€™</a></td><td><a href="#">Link 100</a></td></tr>

</table>
  <!-- SHEETS -->
  <h2>Theo dÃµi tiáº¿n Ä‘á»™ há»‘ khoan</h2>
  <p>Tiáº¿n Ä‘á»™ há»‘ khoan Ä‘Æ°á»£c hiá»ƒn thá»‹ khi nháº­p sá»• má»Ÿ máº«u vÃ  sá»‘ liá»‡u thÃ­ nghiá»‡m vÃ o biá»ƒu Google Sheets trong thÆ° má»¥c Biá»ƒu nháº­p sá»‘ thÃ­ nghiá»‡m. Chá»n tÃªn há»‘ khoan trong pháº§n xá»• xuá»‘ng Ä‘á»ƒ hiá»‡n thá»‹ biá»ƒu cÃ³ tÃªn tÆ°Æ¡ng á»©ng.</p>
  <select id="sheetSelector"></select>
<div id="sheetContainer"></div>

<script>
async function loadSheets() {
  const response = await fetch("https://script.google.com/macros/s/AKfycbxicVGWO8hV0Lk90vrKqQV7w-Z-kNQWhvFcBzzSSDgVfN3ASR2vb4tcPB8qFgl4zHoT/exec");
  const sheets = await response.json();
  const selector = document.getElementById("sheetSelector");
  const container = document.getElementById("sheetContainer");

  // táº¡o option
  sheets.forEach(sheet => {
    const opt = document.createElement("option");
    opt.value = sheet.url;
    opt.textContent = sheet.name;
    selector.appendChild(opt);
  });

  // náº¿u cÃ³ Ã­t nháº¥t 1 file thÃ¬ hiá»ƒn thá»‹ luÃ´n file Ä‘áº§u tiÃªn
  if (sheets.length > 0) {
    selector.value = sheets[0].url; // chá»n máº·c Ä‘á»‹nh
    container.innerHTML = `
      <div class="sheet-frame">
        <iframe src="${sheets[0].url}" width="100%" height="600" frameborder="0"></iframe>
      </div>`;
  }

  // Ä‘á»•i khi chá»n dropdown
  selector.addEventListener("change", () => {
    container.innerHTML = `
      <div class="sheet-frame">
        <iframe src="${selector.value}" width="100%" height="600" frameborder="0"></iframe>
      </div>`;
  });
}

loadSheets();
</script>


  <!-- Form + Sheets -->
  <h2>CÃ´ng viá»‡c & Theo dÃµi</h2>
  <p>Má»—i ngÃ y, cÃ¡c TNV Ä‘iá»n thÃ´ng tin vÃ  Ä‘Ã¡nh dáº¥u cÃ¡c cÃ´ng Ä‘oáº¡n tham gia vÃ o Google Form vÃ  gá»­i Ä‘i, dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c lÆ°u láº¡i vÃ  thá»‘ng kÃª.</p>
  <!-- Google Form -->
  <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfRll9yQzmv5t9OHBKAZFYpNKtb6chKqn8lcJ3nfc1U8NFEiA/viewform?embedded=true"></iframe>
  <p>Sau khi nháº­n Ä‘Æ°á»£c dá»¯ liá»‡u tá»« Google Form, biá»ƒu Google Sheets sau Ä‘Ã¢y sáº½ xá»­ lÃ½ dá»¯ liá»‡u Ä‘Ã³ vÃ  tÃ­nh Ä‘iá»ƒm cho tá»«ng TNV theo tá»«ng ngÃ y vÃ  tÃ­nh Ä‘iá»ƒm trung bÃ¬nh theo sá»‘ ngÃ y tÃ¹y chá»n.</p>

  <!-- Google Sheets -->
  <iframe src="https://docs.google.com/spreadsheets/d/1t6ZJf5wu2iSf5spfFx-fP8tT9-AZUEQ-17xUn8YiSMo/edit?usp=sharing"></iframe>
  <hr>
  <h2>CÃ¡c biá»ƒu quan trá»ng</h2> 
  <p>Biá»ƒu hiá»ƒn thá»‹ á»Ÿ dashboard chá»‰ Ä‘á»ƒ theo dÃµi, trÃ¡nh chá»‰nh sá»­a. Náº¿u muá»‘n chá»‰nh sá»­a, vui lÃ²ng truy cáº­p vÃ o cÃ¡c link sau vÃ  yÃªu cáº§u cáº¥p quyá»n truy cáº­p Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh báº£o máº­t.</p>
  <div class="folder-links">
    <a href="https://docs.google.com/spreadsheets/d/15WLUyBcH235TF4f0KaM145X5Pv2kvi7DaqhyTAxg8rQ/edit?usp=sharing">Biá»ƒu theo dÃµi tiáº¿n Ä‘á»™ há»‘ khoan</a>
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfRll9yQzmv5t9OHBKAZFYpNKtb6chKqn8lcJ3nfc1U8NFEiA/viewform?usp=sharing&ouid=105033677416426965311">Form theo dÃµi cÃ´ng viá»‡c hÃ ng ngÃ y</a>
    <a href="https://docs.google.com/spreadsheets/d/1t6ZJf5wu2iSf5spfFx-fP8tT9-AZUEQ-17xUn8YiSMo/edit?usp=sharing">Biá»ƒu thá»‘ng kÃª Ä‘iá»ƒm cá»§a cÃ¡c TNV</a>
  </div>
  <p style="text-align: center; font-weight: bold; font-size: 22px;">
  â‹†ï½¡â€§ËšÊšğŸ“ÉËšâ€§ï½¡â‹†CHÃšC CÃC Báº N LÃ€M VIá»†C HIá»†U QUáº¢ VÃ€ VUI Váºº!â‹†ï½¡â€§ËšÊšğŸ“ÉËšâ€§ï½¡â‹†
</p>

  
</body>

<script>
  const isMobile = /Mobi|Android/i.test(navigator.userAgent);

  // Náº¿u lÃ  mobile thÃ¬ hiá»‡n input upload
  if (isMobile) {
    document.getElementById('pcCamera').style.display = 'none';
    document.getElementById('mobileCamera').style.display = 'block';
  }

  // Mobile: upload tá»« input file
  const input = document.getElementById('cameraInput');
  const uploadBtn = document.getElementById('uploadBtn');
  if (uploadBtn) {
    uploadBtn.onclick = () => {
      if (!input.files.length) {
        alert("ChÆ°a chá»n áº£nh");
        return;
      }
      const file = input.files[0];
      const ext = file.name.split('.').pop().toLowerCase();   // láº¥y Ä‘uÃ´i gá»‘c
      const reader = new FileReader();
      reader.onloadend = () => {
        uploadImage(reader.result, "mobile_" + Date.now() + "." + ext);
      };
      reader.readAsDataURL(file);
    };
  }
  // HÃ m resize & upload
  function uploadImage(dataUrl, filename, maxWidth = 1024, maxHeight = 1024) {
    const img = new Image();
    img.onload = () => {
      let width = img.width;
      let height = img.height;
      const ratio = Math.min(maxWidth / width, maxHeight / height, 1);
      width *= ratio;
      height *= ratio;

      const canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0, width, height);

      const resizedDataUrl = canvas.toDataURL("image/jpeg", 0.8);
      const mimeMatch = resizedDataUrl.match(/^data:(image\/\w+);base64,/);
      const mimeType = mimeMatch ? mimeMatch[1] : "image/jpeg";
      const base64Data = resizedDataUrl.replace(/^data:image\/\w+;base64,/, "").replace(/\s/g, "");

      fetch("/.netlify/functions/uploadProxy", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          image: base64Data,
          filename: filename,
          mimeType: mimeType
        })
      })
      .then(res => res.json())
      .then(txt => {
        if(txt.status === "success") {
          alert("Uploaded: " + txt.fileUrl);
        } else {
          alert("Upload error: " + txt.message);
        }
      })
      .catch(err => alert("Upload failed: " + err));
    };
    img.src = dataUrl;
  }
</script>
  
</html>






















